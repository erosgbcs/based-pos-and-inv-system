<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS & Inventory Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        h1 i {
            font-size: 2.2rem;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        @media (max-width: 1100px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }

        .main-panel {
            display: grid;
            grid-template-rows: auto auto;
            gap: 30px;
        }

        .section {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #2a5298;
            padding-bottom: 10px;
            border-bottom: 2px solid #eaeaea;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .section-title-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .date-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: #f8f9fa;
            padding: 8px 15px;
            border-radius: 5px;
        }

        .date-selector input {
            border: 1px solid #ddd;
            padding: 5px 10px;
            border-radius: 4px;
        }

        /* Products Section */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
        }

        .product-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        .product-image {
            height: 140px;
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #2a5298;
        }

        .product-info {
            padding: 15px;
        }

        .product-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .product-price {
            color: #2a5298;
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 8px;
        }

        .product-stock {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }

        .in-stock {
            color: #28a745;
            font-weight: 500;
        }

        .low-stock {
            color: #ffc107;
            font-weight: 500;
        }

        .out-of-stock {
            color: #dc3545;
            font-weight: 500;
        }

        .add-to-cart {
            background-color: #2a5298;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            width: 100%;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }

        .add-to-cart:hover {
            background-color: #1e3c72;
        }

        .add-to-cart:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        /* Cart Section */
        .cart-items {
            max-height: 350px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eaeaea;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-info h4 {
            margin-bottom: 5px;
        }

        .cart-item-price {
            color: #2a5298;
            font-weight: bold;
        }

        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cart-item-total {
            font-weight: bold;
            color: #2a5298;
            min-width: 80px;
            text-align: right;
        }

        .quantity-btn {
            background-color: #f0f0f0;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cart-total {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .total-amount {
            font-weight: bold;
            font-size: 1.5rem;
            color: #2a5298;
        }

        .checkout-btn {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            width: 100%;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        .checkout-btn:hover {
            background-color: #218838;
        }

        /* Inventory Section */
        .inventory-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .inventory-table th,
        .inventory-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eaeaea;
        }

        .inventory-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2a5298;
        }

        .inventory-table tr:hover {
            background-color: #f8f9fa;
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-in-stock {
            background-color: #d4edda;
            color: #155724;
        }

        .status-low-stock {
            background-color: #fff3cd;
            color: #856404;
        }

        .status-out-of-stock {
            background-color: #f8d7da;
            color: #721c24;
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .tab {
            padding: 12px 25px;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab.active {
            color: #2a5298;
            border-bottom: 3px solid #2a5298;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #2a5298;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.95rem;
            color: #666;
        }

        /* Weekly Report Section */
        .weekly-report {
            margin-top: 30px;
        }

        .report-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .week-selector {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .week-nav-btn {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .week-nav-btn:hover {
            background-color: #e9ecef;
        }

        .current-week {
            font-weight: 600;
            color: #2a5298;
        }

        .export-btn {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.3s;
        }

        .export-btn:hover {
            background-color: #218838;
        }

        .report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .report-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .report-card-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #2a5298;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-container {
            height: 250px;
            margin-top: 15px;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .report-table th,
        .report-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eaeaea;
        }

        .report-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2a5298;
        }

        .report-table tr:hover {
            background-color: #f8f9fa;
        }

        .metric-highlight {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2a5298;
            margin: 10px 0;
        }

        .metric-change {
            font-size: 0.9rem;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: 500;
        }

        .metric-change.positive {
            background-color: #d4edda;
            color: #155724;
        }

        .metric-change.negative {
            background-color: #f8d7da;
            color: #721c24;
        }

        .metric-change.neutral {
            background-color: #e2e3e5;
            color: #383d41;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }
            
            .inventory-table {
                display: block;
                overflow-x: auto;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .section {
                padding: 20px 15px;
            }
            
            .report-controls {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .week-selector {
                width: 100%;
                justify-content: space-between;
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.3s, transform 0.3s;
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .notification.success {
            background-color: #28a745;
        }

        .notification.error {
            background-color: #dc3545;
        }

        .notification.info {
            background-color: #17a2b8;
        }

        .empty-cart {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .empty-cart i {
            font-size: 3rem;
            color: #e0e0e0;
            margin-bottom: 15px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: #2a5298;
            color: white;
        }

        .btn-primary:hover {
            background-color: #1e3c72;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-cash-register"></i> POS & Inventory Management System</h1>
            <p class="subtitle">Manage sales, track inventory, and view weekly reports</p>
        </header>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-label">Total Products</div>
                <div class="stat-value" id="totalProducts">12</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Items in Stock</div>
                <div class="stat-value" id="itemsInStock">89</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Today's Sales</div>
                <div class="stat-value">$<span id="todaySales">245.50</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Weekly Revenue</div>
                <div class="stat-value">$<span id="weeklyRevenue">1,842.75</span></div>
            </div>
        </div>

        <div class="dashboard">
            <div class="main-panel">
                <div class="section">
                    <div class="tabs">
                        <div class="tab active" data-tab="products">Products</div>
                        <div class="tab" data-tab="inventory">Inventory Management</div>
                        <div class="tab" data-tab="weekly-report">Weekly Report</div>
                    </div>

                    <div id="products" class="tab-content active">
                        <div class="section-title">
                            <i class="fas fa-boxes"></i>
                            Available Products
                        </div>
                        <div class="products-grid" id="productsContainer">
                            <!-- Products will be loaded by JavaScript -->
                        </div>
                    </div>

                    <div id="inventory" class="tab-content">
                        <div class="section-title">
                            <i class="fas fa-clipboard-list"></i>
                            Inventory Management
                        </div>
                        <table class="inventory-table">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Category</th>
                                    <th>Stock</th>
                                    <th>Price</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTable">
                                <!-- Inventory data will be loaded by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <div id="weekly-report" class="tab-content">
                        <div class="section-title">
                            <div>
                                <i class="fas fa-chart-line"></i>
                                Weekly Sales Report
                            </div>
                            <div class="section-title-controls">
                                <div class="date-selector">
                                    <label for="weekStart">Week Starting:</label>
                                    <input type="date" id="weekStart" value="2023-10-23">
                                </div>
                                <button class="export-btn" id="exportReportBtn">
                                    <i class="fas fa-download"></i> Export Report
                                </button>
                            </div>
                        </div>
                        
                        <div class="weekly-report">
                            <div class="report-controls">
                                <div class="week-selector">
                                    <button class="week-nav-btn" id="prevWeekBtn">
                                        <i class="fas fa-chevron-left"></i> Previous Week
                                    </button>
                                    <div class="current-week" id="currentWeekRange">Oct 23 - Oct 29, 2023</div>
                                    <button class="week-nav-btn" id="nextWeekBtn">
                                        Next Week <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                                <button class="btn btn-primary" id="refreshReportBtn">
                                    <i class="fas fa-sync-alt"></i> Refresh Report
                                </button>
                            </div>

                            <div class="report-grid">
                                <div class="report-card">
                                    <div class="report-card-title">
                                        <i class="fas fa-chart-bar"></i> Weekly Sales Trend
                                    </div>
                                    <canvas id="salesChart" class="chart-container"></canvas>
                                </div>

                                <div class="report-card">
                                    <div class="report-card-title">
                                        <i class="fas fa-chart-pie"></i> Sales by Category
                                    </div>
                                    <canvas id="categoryChart" class="chart-container"></canvas>
                                </div>

                                <div class="report-card">
                                    <div class="report-card-title">
                                        <i class="fas fa-dollar-sign"></i> Revenue Summary
                                    </div>
                                    <div class="metric-highlight" id="weeklyRevenueTotal">$1,842.75</div>
                                    <div style="margin-bottom: 15px;">
                                        <span>vs Previous Week: </span>
                                        <span class="metric-change positive" id="revenueChange">+12.5%</span>
                                    </div>
                                    <div>
                                        <span>Average Daily Sales: </span>
                                        <span id="avgDailySales">$263.25</span>
                                    </div>
                                    <div>
                                        <span>Best Day: </span>
                                        <span id="bestDay">Tuesday ($452.80)</span>
                                    </div>
                                </div>

                                <div class="report-card">
                                    <div class="report-card-title">
                                        <i class="fas fa-shopping-cart"></i> Sales Performance
                                    </div>
                                    <div class="metric-highlight" id="totalTransactions">47</div>
                                    <div style="margin-bottom: 15px;">
                                        <span>Transactions This Week</span>
                                    </div>
                                    <div>
                                        <span>Items Sold: </span>
                                        <span id="itemsSold">89</span>
                                    </div>
                                    <div>
                                        <span>Average Transaction: </span>
                                        <span id="avgTransaction">$39.21</span>
                                    </div>
                                    <div>
                                        <span>Top Product: </span>
                                        <span id="topProduct">Laptop Pro (12 sold)</span>
                                    </div>
                                </div>
                            </div>

                            <div class="report-card">
                                <div class="report-card-title">
                                    <i class="fas fa-table"></i> Daily Sales Breakdown
                                </div>
                                <table class="report-table">
                                    <thead>
                                        <tr>
                                            <th>Day</th>
                                            <th>Date</th>
                                            <th>Transactions</th>
                                            <th>Items Sold</th>
                                            <th>Revenue</th>
                                            <th>Avg. Transaction</th>
                                        </tr>
                                    </thead>
                                    <tbody id="dailySalesTable">
                                        <!-- Daily sales data will be loaded by JavaScript -->
                                    </tbody>
                                </table>
                            </div>

                            <div class="report-card" style="margin-top: 25px;">
                                <div class="report-card-title">
                                    <i class="fas fa-exclamation-triangle"></i> Inventory Insights
                                </div>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                    <div>
                                        <h4>Low Stock Items (< 10)</h4>
                                        <ul id="lowStockList" style="margin-top: 10px; padding-left: 20px;">
                                            <!-- Low stock items will be loaded by JavaScript -->
                                        </ul>
                                    </div>
                                    <div>
                                        <h4>Top Selling Products</h4>
                                        <ul id="topProductsList" style="margin-top: 10px; padding-left: 20px;">
                                            <!-- Top products will be loaded by JavaScript -->
                                        </ul>
                                    </div>
                                    <div>
                                        <h4>Recommendations</h4>
                                        <ul id="recommendationsList" style="margin-top: 10px; padding-left: 20px;">
                                            <!-- Recommendations will be loaded by JavaScript -->
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">
                    <i class="fas fa-shopping-cart"></i>
                    Shopping Cart
                </div>
                <div class="cart-items" id="cartItems">
                    <!-- Cart items will be loaded by JavaScript -->
                    <div class="empty-cart">
                        <i class="fas fa-shopping-cart"></i>
                        <p>Your cart is empty</p>
                        <p>Add products from the list</p>
                    </div>
                </div>
                <div class="cart-total">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">$0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Tax (10%):</span>
                        <span id="tax">$0.00</span>
                    </div>
                    <div class="total-row total-amount">
                        <span>Total:</span>
                        <span id="total">$0.00</span>
                    </div>
                    <button class="checkout-btn" id="checkoutBtn">
                        <i class="fas fa-credit-card"></i> Checkout
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script>
        // Sample product data
        const products = [
            { id: 1, name: "Laptop Pro", category: "Electronics", price: 999.99, stock: 15, image: "ðŸ’»" },
            { id: 2, name: "Wireless Mouse", category: "Electronics", price: 29.99, stock: 42, image: "ðŸ–±ï¸" },
            { id: 3, name: "Mechanical Keyboard", category: "Electronics", price: 89.99, stock: 23, image: "âŒ¨ï¸" },
            { id: 4, name: "Office Chair", category: "Furniture", price: 249.99, stock: 8, image: "ðŸª‘" },
            { id: 5, name: "Desk Lamp", category: "Furniture", price: 34.99, stock: 17, image: "ðŸ’¡" },
            { id: 6, name: "Notebook Set", category: "Stationery", price: 12.99, stock: 56, image: "ðŸ““" },
            { id: 7, name: "Pen Set", category: "Stationery", price: 8.99, stock: 0, image: "ðŸ–Šï¸" },
            { id: 8, name: "Coffee Mug", category: "Home", price: 14.99, stock: 32, image: "â˜•" },
            { id: 9, name: "Water Bottle", category: "Home", price: 24.99, stock: 5, image: "ðŸ’§" },
            { id: 10, name: "Backpack", category: "Accessories", price: 49.99, stock: 12, image: "ðŸŽ’" },
            { id: 11, name: "Phone Case", category: "Accessories", price: 19.99, stock: 28, image: "ðŸ“±" },
            { id: 12, name: "USB Cable", category: "Electronics", price: 9.99, stock: 64, image: "ðŸ”Œ" }
        ];

        // Sample sales data for the past 4 weeks
        let salesData = {
            // Week 1: Oct 23 - Oct 29, 2023
            "2023-10-23": {
                total: 1842.75,
                transactions: 47,
                itemsSold: 89,
                dailyData: {
                    "2023-10-23": { revenue: 245.50, transactions: 6, items: 12 },
                    "2023-10-24": { revenue: 452.80, transactions: 11, items: 22 },
                    "2023-10-25": { revenue: 398.25, transactions: 9, items: 17 },
                    "2023-10-26": { revenue: 312.90, transactions: 8, items: 15 },
                    "2023-10-27": { revenue: 278.40, transactions: 7, items: 14 },
                    "2023-10-28": { revenue: 98.75, transactions: 4, items: 6 },
                    "2023-10-29": { revenue: 56.15, transactions: 2, items: 3 }
                },
                categoryData: {
                    "Electronics": 1245.80,
                    "Furniture": 284.99,
                    "Stationery": 21.98,
                    "Home": 218.96,
                    "Accessories": 71.02
                },
                topProducts: [
                    { id: 1, name: "Laptop Pro", sold: 12, revenue: 11999.88 },
                    { id: 2, name: "Wireless Mouse", sold: 24, revenue: 719.76 },
                    { id: 4, name: "Office Chair", sold: 3, revenue: 749.97 }
                ]
            },
            // Week 2: Oct 16 - Oct 22, 2023
            "2023-10-16": {
                total: 1638.20,
                transactions: 41,
                itemsSold: 78,
                dailyData: {
                    "2023-10-16": { revenue: 312.45, transactions: 8, items: 15 },
                    "2023-10-17": { revenue: 425.60, transactions: 10, items: 21 },
                    "2023-10-18": { revenue: 287.30, transactions: 7, items: 13 },
                    "2023-10-19": { revenue: 198.75, transactions: 5, items: 9 },
                    "2023-10-20": { revenue: 315.90, transactions: 8, items: 15 },
                    "2023-10-21": { revenue: 78.40, transactions: 2, items: 4 },
                    "2023-10-22": { revenue: 19.80, transactions: 1, items: 1 }
                },
                categoryData: {
                    "Electronics": 1024.50,
                    "Furniture": 249.99,
                    "Stationery": 38.97,
                    "Home": 198.72,
                    "Accessories": 126.02
                },
                topProducts: [
                    { id: 1, name: "Laptop Pro", sold: 8, revenue: 7999.92 },
                    { id: 3, name: "Mechanical Keyboard", sold: 10, revenue: 899.90 },
                    { id: 10, name: "Backpack", sold: 8, revenue: 399.92 }
                ]
            },
            // Week 3: Oct 9 - Oct 15, 2023
            "2023-10-09": {
                total: 1956.40,
                transactions: 52,
                itemsSold: 96,
                dailyData: {
                    "2023-10-09": { revenue: 412.30, transactions: 10, items: 19 },
                    "2023-10-10": { revenue: 389.45, transactions: 9, items: 18 },
                    "2023-10-11": { revenue: 287.60, transactions: 7, items: 13 },
                    "2023-10-12": { revenue: 325.90, transactions: 8, items: 16 },
                    "2023-10-13": { revenue: 452.80, transactions: 12, items: 23 },
                    "2023-10-14": { revenue: 68.95, transactions: 4, items: 5 },
                    "2023-10-15": { revenue: 19.40, transactions: 2, items: 2 }
                },
                categoryData: {
                    "Electronics": 1456.20,
                    "Furniture": 284.99,
                    "Stationery": 51.96,
                    "Home": 103.96,
                    "Accessories": 59.29
                },
                topProducts: [
                    { id: 1, name: "Laptop Pro", sold: 10, revenue: 9999.90 },
                    { id: 4, name: "Office Chair", sold: 4, revenue: 999.96 },
                    { id: 2, name: "Wireless Mouse", sold: 18, revenue: 539.82 }
                ]
            },
            // Week 4: Oct 2 - Oct 8, 2023
            "2023-10-02": {
                total: 1425.60,
                transactions: 37,
                itemsSold: 71,
                dailyData: {
                    "2023-10-02": { revenue: 287.40, transactions: 7, items: 14 },
                    "2023-10-03": { revenue: 398.20, transactions: 9, items: 19 },
                    "2023-10-04": { revenue: 245.80, transactions: 6, items: 12 },
                    "2023-10-05": { revenue: 198.75, transactions: 5, items: 9 },
                    "2023-10-06": { revenue: 265.90, transactions: 7, items: 13 },
                    "2023-10-07": { revenue: 19.85, transactions: 2, items: 3 },
                    "2023-10-08": { revenue: 9.70, transactions: 1, items: 1 }
                },
                categoryData: {
                    "Electronics": 876.40,
                    "Furniture": 284.99,
                    "Stationery": 90.93,
                    "Home": 103.96,
                    "Accessories": 69.32
                },
                topProducts: [
                    { id: 3, name: "Mechanical Keyboard", sold: 12, revenue: 1079.88 },
                    { id: 6, name: "Notebook Set", sold: 15, revenue: 194.85 },
                    { id: 2, name: "Wireless Mouse", sold: 11, revenue: 329.89 }
                ]
            }
        };

        // Cart array
        let cart = [];

        // Current week for reporting
        let currentWeekStart = "2023-10-23";

        // DOM elements
        const productsContainer = document.getElementById('productsContainer');
        const cartItems = document.getElementById('cartItems');
        const subtotalElement = document.getElementById('subtotal');
        const taxElement = document.getElementById('tax');
        const totalElement = document.getElementById('total');
        const checkoutBtn = document.getElementById('checkoutBtn');
        const notification = document.getElementById('notification');
        const inventoryTable = document.getElementById('inventoryTable');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');

        // Stats elements
        const totalProductsElement = document.getElementById('totalProducts');
        const itemsInStockElement = document.getElementById('itemsInStock');
        const todaySalesElement = document.getElementById('todaySales');
        const weeklyRevenueElement = document.getElementById('weeklyRevenue');

        // Weekly report elements
        const weekStartInput = document.getElementById('weekStart');
        const currentWeekRangeElement = document.getElementById('currentWeekRange');
        const prevWeekBtn = document.getElementById('prevWeekBtn');
        const nextWeekBtn = document.getElementById('nextWeekBtn');
        const refreshReportBtn = document.getElementById('refreshReportBtn');
        const exportReportBtn = document.getElementById('exportReportBtn');
        const weeklyRevenueTotalElement = document.getElementById('weeklyRevenueTotal');
        const revenueChangeElement = document.getElementById('revenueChange');
        const avgDailySalesElement = document.getElementById('avgDailySales');
        const bestDayElement = document.getElementById('bestDay');
        const totalTransactionsElement = document.getElementById('totalTransactions');
        const itemsSoldElement = document.getElementById('itemsSold');
        const avgTransactionElement = document.getElementById('avgTransaction');
        const topProductElement = document.getElementById('topProduct');
        const dailySalesTable = document.getElementById('dailySalesTable');
        const lowStockList = document.getElementById('lowStockList');
        const topProductsList = document.getElementById('topProductsList');
        const recommendationsList = document.getElementById('recommendationsList');

        // Chart instances
        let salesChart = null;
        let categoryChart = null;

        // Initialize the app
        function init() {
            renderProducts();
            renderInventoryTable();
            updateCartDisplay();
            updateStats();
            updateWeeklyReport();
            
            // Set up event listeners
            checkoutBtn.addEventListener('click', checkout);
            
            // Tab switching
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    switchTab(tabId);
                    
                    // If switching to weekly report, update it
                    if (tabId === 'weekly-report') {
                        updateWeeklyReport();
                    }
                });
            });
            
            // Weekly report event listeners
            weekStartInput.addEventListener('change', () => {
                currentWeekStart = weekStartInput.value;
                updateWeeklyReport();
            });
            
            prevWeekBtn.addEventListener('click', goToPreviousWeek);
            nextWeekBtn.addEventListener('click', goToNextWeek);
            refreshReportBtn.addEventListener('click', updateWeeklyReport);
            exportReportBtn.addEventListener('click', exportReport);
            
            // Set default week start to today's Monday
            setDefaultWeekStart();
        }

        // Set default week start to the most recent Monday
        function setDefaultWeekStart() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday, etc.
            const diff = dayOfWeek === 0 ? -6 : 1 - dayOfWeek; // Calculate days to subtract to get Monday
            
            const monday = new Date(today);
            monday.setDate(today.getDate() + diff);
            
            // Format as YYYY-MM-DD
            const year = monday.getFullYear();
            const month = String(monday.getMonth() + 1).padStart(2, '0');
            const day = String(monday.getDate()).padStart(2, '0');
            
            currentWeekStart = `${year}-${month}-${day}`;
            weekStartInput.value = currentWeekStart;
            
            // Update week range display
            updateWeekRangeDisplay();
        }

        // Update week range display
        function updateWeekRangeDisplay() {
            const startDate = new Date(currentWeekStart);
            const endDate = new Date(startDate);
            endDate.setDate(startDate.getDate() + 6);
            
            const startFormatted = formatDate(startDate);
            const endFormatted = formatDate(endDate);
            
            currentWeekRangeElement.textContent = `${startFormatted} - ${endFormatted}, ${startDate.getFullYear()}`;
        }

        // Format date as "Mon DD"
        function formatDate(date) {
            const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            const month = months[date.getMonth()];
            const day = date.getDate();
            return `${month} ${day}`;
        }

        // Go to previous week
        function goToPreviousWeek() {
            const date = new Date(currentWeekStart);
            date.setDate(date.getDate() - 7);
            
            // Format as YYYY-MM-DD
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            
            currentWeekStart = `${year}-${month}-${day}`;
            weekStartInput.value = currentWeekStart;
            updateWeeklyReport();
        }

        // Go to next week
        function goToNextWeek() {
            const date = new Date(currentWeekStart);
            date.setDate(date.getDate() + 7);
            
            // Format as YYYY-MM-DD
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            
            currentWeekStart = `${year}-${month}-${day}`;
            weekStartInput.value = currentWeekStart;
            updateWeeklyReport();
        }

        // Render products to the products grid
        function renderProducts() {
            productsContainer.innerHTML = '';
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                // Determine stock status
                let stockStatus = '';
                let stockClass = '';
                
                if (product.stock === 0) {
                    stockStatus = 'Out of Stock';
                    stockClass = 'out-of-stock';
                } else if (product.stock < 10) {
                    stockStatus = `Low Stock (${product.stock})`;
                    stockClass = 'low-stock';
                } else {
                    stockStatus = `In Stock (${product.stock})`;
                    stockClass = 'in-stock';
                }
                
                productCard.innerHTML = `
                    <div class="product-image">${product.image}</div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">$${product.price.toFixed(2)}</div>
                        <div class="product-stock ${stockClass}">${stockStatus}</div>
                        <button class="add-to-cart" data-id="${product.id}" ${product.stock === 0 ? 'disabled' : ''}>
                            ${product.stock === 0 ? 'Out of Stock' : 'Add to Cart'}
                        </button>
                    </div>
                `;
                
                productsContainer.appendChild(productCard);
            });
            
            // Add event listeners to Add to Cart buttons
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.getAttribute('data-id'));
                    addToCart(productId);
                });
            });
        }

        // Render inventory table
        function renderInventoryTable() {
            inventoryTable.innerHTML = '';
            
            products.forEach(product => {
                const row = document.createElement('tr');
                
                // Determine status badge
                let statusBadge = '';
                if (product.stock === 0) {
                    statusBadge = '<span class="status-badge status-out-of-stock">Out of Stock</span>';
                } else if (product.stock < 10) {
                    statusBadge = `<span class="status-badge status-low-stock">Low Stock (${product.stock})</span>`;
                } else {
                    statusBadge = `<span class="status-badge status-in-stock">In Stock (${product.stock})</span>`;
                }
                
                row.innerHTML = `
                    <td>${product.image} ${product.name}</td>
                    <td>${product.category}</td>
                    <td>${product.stock}</td>
                    <td>$${product.price.toFixed(2)}</td>
                    <td>${statusBadge}</td>
                    <td>
                        <button class="quantity-btn" onclick="adjustInventory(${product.id}, 'increase')">+</button>
                        <button class="quantity-btn" onclick="adjustInventory(${product.id}, 'decrease')">-</button>
                    </td>
                `;
                
                inventoryTable.appendChild(row);
            });
        }

        // Switch between tabs
        function switchTab(tabId) {
            // Update active tab
            tabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            // Update active tab content
            tabContents.forEach(content => {
                if (content.id === tabId) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        // Update weekly report
        function updateWeeklyReport() {
            updateWeekRangeDisplay();
            
            // Get data for current week
            const weekData = salesData[currentWeekStart] || generateEmptyWeekData();
            
            // Update summary metrics
            weeklyRevenueTotalElement.textContent = `$${weekData.total.toFixed(2)}`;
            weeklyRevenueElement.textContent = weekData.total.toFixed(2);
            
            // Calculate revenue change vs previous week
            const prevWeekStart = getPreviousWeekStart(currentWeekStart);
            const prevWeekData = salesData[prevWeekStart];
            
            if (prevWeekData && typeof prevWeekData.total === 'number' && prevWeekData.total > 0) {
                const change = ((weekData.total - prevWeekData.total) / prevWeekData.total) * 100;
                revenueChangeElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(1)}%`;
                revenueChangeElement.className = `metric-change ${change > 0 ? 'positive' : change < 0 ? 'negative' : 'neutral'}`;
            } else {
                revenueChangeElement.textContent = "N/A";
                revenueChangeElement.className = "metric-change neutral";
            }
            
            // Calculate average daily sales
            const avgDaily = weekData.total / 7;
            avgDailySalesElement.textContent = `$${avgDaily.toFixed(2)}`;
            
            // Find best day
            let bestDay = "";
            let bestRevenue = 0;
            for (const [date, dayData] of Object.entries(weekData.dailyData)) {
                if (dayData.revenue > bestRevenue) {
                    bestRevenue = dayData.revenue;
                    const dateObj = new Date(date);
                    const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                    bestDay = days[dateObj.getDay()];
                }
            }
            bestDayElement.textContent = `${bestDay} ($${bestRevenue.toFixed(2)})`;
            
            // Update transaction metrics
            totalTransactionsElement.textContent = weekData.transactions;
            itemsSoldElement.textContent = weekData.itemsSold;
            
            let avgTransaction = 0;
            if (weekData.transactions && weekData.transactions > 0) {
                avgTransaction = weekData.total / weekData.transactions;
            }
            avgTransactionElement.textContent = `$${avgTransaction.toFixed(2)}`;
            
            // Update top product
            if (weekData.topProducts && weekData.topProducts.length > 0) {
                const topProduct = weekData.topProducts[0];
                topProductElement.textContent = `${topProduct.name} (${topProduct.sold} sold)`;
            }
            
            // Update daily sales table
            updateDailySalesTable(weekData);
            
            // Update inventory insights
            updateInventoryInsights();
            
            // Update charts
            updateCharts(weekData);
        }

        // Generate empty week data if no data exists
        function generateEmptyWeekData() {
            const days = {};
            const startDate = new Date(currentWeekStart);
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                const dateStr = date.toISOString().split('T')[0];
                days[dateStr] = { revenue: 0, transactions: 0, items: 0 };
            }
            
            return {
                total: 0,
                transactions: 0,
                itemsSold: 0,
                dailyData: days,
                categoryData: {
                    "Electronics": 0,
                    "Furniture": 0,
                    "Stationery": 0,
                    "Home": 0,
                    "Accessories": 0
                },
                topProducts: []
            };
        }

        // Get previous week start date
        function getPreviousWeekStart(dateStr) {
            const date = new Date(dateStr);
            date.setDate(date.getDate() - 7);
            return date.toISOString().split('T')[0];
        }

        // Update daily sales table
        function updateDailySalesTable(weekData) {
            dailySalesTable.innerHTML = '';
            
            const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            const startDate = new Date(currentWeekStart);
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                const dateStr = date.toISOString().split('T')[0];
                const dayData = weekData.dailyData[dateStr] || { revenue: 0, transactions: 0, items: 0 };
                
                const dayName = daysOfWeek[date.getDay()];
                const dateFormatted = `${date.getMonth() + 1}/${date.getDate()}`;
                const avgTransaction = dayData.transactions > 0 ? dayData.revenue / dayData.transactions : 0;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dayName}</td>
                    <td>${dateFormatted}</td>
                    <td>${dayData.transactions}</td>
                    <td>${dayData.items}</td>
                    <td>$${dayData.revenue.toFixed(2)}</td>
                    <td>$${avgTransaction.toFixed(2)}</td>
                `;
                
                dailySalesTable.appendChild(row);
            }
            
            // Add total row
            const totalRow = document.createElement('tr');
            totalRow.style.fontWeight = 'bold';
            totalRow.style.backgroundColor = '#f8f9fa';
            // Safely compute average transaction for the total row
            const totalAvgTransaction = (weekData.transactions && weekData.transactions > 0) ? (weekData.total / weekData.transactions) : 0;
            totalRow.innerHTML = `
                <td>Total</td>
                <td></td>
                <td>${weekData.transactions}</td>
                <td>${weekData.itemsSold}</td>
                <td>$${weekData.total.toFixed(2)}</td>
                <td>$${totalAvgTransaction.toFixed(2)}</td>
            `;
            dailySalesTable.appendChild(totalRow);
        }

        // Update inventory insights
        function updateInventoryInsights() {
            // Low stock items
            lowStockList.innerHTML = '';
            const lowStockProducts = products.filter(p => p.stock > 0 && p.stock < 10);
            
            if (lowStockProducts.length === 0) {
                lowStockList.innerHTML = '<li>No low stock items</li>';
            } else {
                lowStockProducts.forEach(product => {
                    const li = document.createElement('li');
                    li.textContent = `${product.name} (${product.stock} left)`;
                    lowStockList.appendChild(li);
                });
            }
            
            // Top selling products (from current week data)
            topProductsList.innerHTML = '';
            const weekData = salesData[currentWeekStart];
            
            if (weekData && weekData.topProducts && weekData.topProducts.length > 0) {
                weekData.topProducts.forEach(product => {
                    const li = document.createElement('li');
                    li.textContent = `${product.name}: ${product.sold} sold ($${product.revenue.toFixed(2)})`;
                    topProductsList.appendChild(li);
                });
            } else {
                topProductsList.innerHTML = '<li>No sales data for this week</li>';
            }
            
            // Recommendations
            recommendationsList.innerHTML = '';
            const recommendations = [];
            
            // Check for out of stock items
            const outOfStockProducts = products.filter(p => p.stock === 0);
            if (outOfStockProducts.length > 0) {
                recommendations.push(`Restock ${outOfStockProducts.length} out-of-stock items`);
            }
            
            // Check for low stock items
            if (lowStockProducts.length > 0) {
                recommendations.push(`Reorder ${lowStockProducts.length} low-stock items`);
            }
            
            // Check for top selling products that might need more stock
            if (weekData && weekData.topProducts) {
                const topProductIds = weekData.topProducts.map(p => p.id);
                const topProductsNeedingStock = products.filter(p => 
                    topProductIds.includes(p.id) && p.stock < 20
                );
                
                if (topProductIds.length > 0 && topProductsNeedingStock.length > 0) {
                    recommendations.push(`Increase stock for top-selling products`);
                }
            }
            
            if (recommendations.length === 0) {
                recommendations.push('Inventory levels are healthy');
            }
            
            recommendations.forEach(rec => {
                const li = document.createElement('li');
                li.textContent = rec;
                recommendationsList.appendChild(li);
            });
        }

        // Update charts
        function updateCharts(weekData) {
            // Destroy existing charts if they exist
            if (salesChart) {
                salesChart.destroy();
            }
            if (categoryChart) {
                categoryChart.destroy();
            }
            
            // Get dates for the week
            const startDate = new Date(currentWeekStart);
            const daysOfWeek = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
            const labels = [];
            const revenueData = [];
            const transactionData = [];
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                const dateStr = date.toISOString().split('T')[0];
                const dayData = weekData.dailyData[dateStr] || { revenue: 0, transactions: 0 };
                
                labels.push(daysOfWeek[date.getDay()]);
                revenueData.push(dayData.revenue);
                transactionData.push(dayData.transactions);
            }
            
            // Sales trend chart
            const salesCtx = document.getElementById('salesChart').getContext('2d');
            salesChart = new Chart(salesCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Revenue ($)',
                            data: revenueData,
                            borderColor: '#2a5298',
                            backgroundColor: 'rgba(42, 82, 152, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Transactions',
                            data: transactionData,
                            borderColor: '#28a745',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.4,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Revenue ($)'
                            }
                        },
                        y1: {
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Transactions'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });
            
            // Category sales chart
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            const categoryLabels = Object.keys(weekData.categoryData);
            const categoryValues = Object.values(weekData.categoryData);
            
            // Generate colors for each category
            const backgroundColors = [
                'rgba(42, 82, 152, 0.7)',
                'rgba(40, 167, 69, 0.7)',
                'rgba(255, 193, 7, 0.7)',
                'rgba(220, 53, 69, 0.7)',
                'rgba(23, 162, 184, 0.7)'
            ];
            
            categoryChart = new Chart(categoryCtx, {
                type: 'doughnut',
                data: {
                    labels: categoryLabels,
                    datasets: [{
                        data: categoryValues,
                        backgroundColor: backgroundColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Add product to cart
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            
            if (!product) return;
            
            // Check if product is already in cart
            const cartItem = cart.find(item => item.id === productId);
            
            if (cartItem) {
                // If already in cart, increase quantity if stock allows
                if (cartItem.quantity < product.stock) {
                    cartItem.quantity++;
                    showNotification(`Added another ${product.name} to cart`, 'success');
                } else {
                    showNotification(`Cannot add more ${product.name}. Only ${product.stock} left in stock.`, 'error');
                    return;
                }
            } else {
                // If not in cart, add new item
                if (product.stock > 0) {
                    cart.push({
                        id: product.id,
                        name: product.name,
                        price: product.price,
                        quantity: 1,
                        image: product.image
                    });
                    showNotification(`${product.name} added to cart`, 'success');
                } else {
                    showNotification(`${product.name} is out of stock`, 'error');
                    return;
                }
            }
            
            updateCartDisplay();
            updateStats();
        }

        // Update cart display
        function updateCartDisplay() {
            // If cart is empty, show empty message
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="empty-cart">
                        <i class="fas fa-shopping-cart"></i>
                        <p>Your cart is empty</p>
                        <p>Add products from the list</p>
                    </div>
                `;
                
                subtotalElement.textContent = '$0.00';
                taxElement.textContent = '$0.00';
                totalElement.textContent = '$0.00';
                
                return;
            }
            
            // Generate cart items HTML
            let cartHTML = '';
            let subtotal = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                cartHTML += `
                    <div class="cart-item">
                        <div class="cart-item-info">
                            <h4>${item.image} ${item.name}</h4>
                            <div class="cart-item-price">$${item.price.toFixed(2)} each</div>
                        </div>
                        <div class="cart-item-quantity">
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">-</button>
                            <span>${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                        </div>
                        <div class="cart-item-total">
                            $${itemTotal.toFixed(2)}
                        </div>
                    </div>
                `;
            });
            
            cartItems.innerHTML = cartHTML;
            
            // Calculate totals
            const tax = subtotal * 0.10;
            const total = subtotal + tax;
            
            subtotalElement.textContent = `$${subtotal.toFixed(2)}`;
            taxElement.textContent = `$${tax.toFixed(2)}`;
            totalElement.textContent = `$${total.toFixed(2)}`;
        }

        // Update item quantity in cart
        function updateQuantity(productId, change) {
            const cartItem = cart.find(item => item.id === productId);
            const product = products.find(p => p.id === productId);
            
            if (!cartItem || !product) return;
            
            const newQuantity = cartItem.quantity + change;
            
            // Check if new quantity is valid
            if (newQuantity < 1) {
                // Remove item from cart if quantity becomes 0
                cart = cart.filter(item => item.id !== productId);
                showNotification(`${cartItem.name} removed from cart`, 'info');
            } else if (newQuantity > product.stock) {
                showNotification(`Only ${product.stock} ${product.name}(s) available`, 'error');
                return;
            } else {
                cartItem.quantity = newQuantity;
            }
            
            updateCartDisplay();
            updateStats();
        }

        // Adjust inventory from inventory management tab
        function adjustInventory(productId, action) {
            const product = products.find(p => p.id === productId);
            
            if (!product) return;
            
            if (action === 'increase') {
                product.stock += 1;
                showNotification(`Increased stock for ${product.name}`, 'success');
            } else if (action === 'decrease') {
                if (product.stock > 0) {
                    product.stock -= 1;
                    showNotification(`Decreased stock for ${product.name}`, 'info');
                } else {
                    showNotification(`${product.name} is already out of stock`, 'error');
                }
            }
            
            // Update displays
            renderProducts();
            renderInventoryTable();
            updateCartDisplay();
            updateStats();
            
            // If on weekly report tab, update insights
            if (document.querySelector('.tab[data-tab="weekly-report"]').classList.contains('active')) {
                updateInventoryInsights();
            }
        }

        // Checkout function
        function checkout() {
            if (cart.length === 0) {
                showNotification('Your cart is empty', 'error');
                return;
            }
            
            // Check if all items are in stock
            let outOfStockItems = [];
            
            cart.forEach(item => {
                const product = products.find(p => p.id === item.id);
                if (product.stock < item.quantity) {
                    outOfStockItems.push(`${product.name} (only ${product.stock} available)`);
                }
            });
            
            if (outOfStockItems.length > 0) {
                showNotification(`Some items are out of stock: ${outOfStockItems.join(', ')}`, 'error');
                return;
            }
            
            // Update stock levels
            cart.forEach(item => {
                const product = products.find(p => p.id === item.id);
                product.stock -= item.quantity;
            });
            
            // Calculate total sale
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.10;
            const total = subtotal + tax;
            
            // Update today's sales
            const todaySales = parseFloat(todaySalesElement.textContent);
            todaySalesElement.textContent = (todaySales + total).toFixed(2);
            
            // Update weekly sales data for current week
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0];
            const weekData = salesData[currentWeekStart] || generateEmptyWeekData();
            
            // Update daily data for today
            if (weekData.dailyData[todayStr]) {
                weekData.dailyData[todayStr].revenue += total;
                weekData.dailyData[todayStr].transactions += 1;
                weekData.dailyData[todayStr].items += cart.reduce((sum, item) => sum + item.quantity, 0);
            }
            
            // Update weekly totals
            weekData.total += total;
            weekData.transactions += 1;
            weekData.itemsSold += cart.reduce((sum, item) => sum + item.quantity, 0);
            
            // Update category data
            cart.forEach(item => {
                const product = products.find(p => p.id === item.id);
                if (product) {
                    const categoryRevenue = item.price * item.quantity;
                    weekData.categoryData[product.category] = (weekData.categoryData[product.category] || 0) + categoryRevenue;
                }
            });
            
            // Save updated week data
            salesData[currentWeekStart] = weekData;
            
            // Show success message
            showNotification(`Checkout successful! Total: $${total.toFixed(2)}`, 'success');
            
            // Clear cart
            cart = [];
            updateCartDisplay();
            
            // Update displays
            renderProducts();
            renderInventoryTable();
            updateStats();
            
            // If on weekly report tab, update it
            if (document.querySelector('.tab[data-tab="weekly-report"]').classList.contains('active')) {
                updateWeeklyReport();
            }
        }

        // Update dashboard statistics
        function updateStats() {
            // Total products
            totalProductsElement.textContent = products.length;
            
            // Items in stock
            const totalStock = products.reduce((sum, product) => sum + product.stock, 0);
            itemsInStockElement.textContent = totalStock;
        }

        // Export report function
        function exportReport() {
            showNotification('Report exported successfully!', 'success');
            
            // In a real application, this would generate a CSV or PDF file
            // For this demo, we'll just show a notification
        }

        // Show notification
        function showNotification(message, type) {
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize the app when the page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>